% load packages
\usepackage{amsmath,amsfonts,float,makecell,hyperref,natbib,changepage,graphicx,multicol}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage[utf8]{inputenc}
\usepackage[onehalfspacing]{setspace}
\usepackage[explicit]{titlesec}
\usepackage[titles]{tocloft}
\usepackage{makeidx}
\usepackage{etoolbox}
\usepackage{atbegshi}% http://ctan.org/pkg/atbegshi
\usepackage{tabu}
\usepackage{caption}

% format captions
 \captionsetup[figure]{labelformat=empty,textfont=it}

% allow breaks in equations
\allowdisplaybreaks

% format chapter + section headings
\titleformat{\chapter}[display]{\Large\bfseries}{}{0.5em}{#1}
\titleformat{\section}[display]{\large\bfseries}{}{0.5em}{#1}

% set page headings to only show page numbers
\pagestyle{plain}

% format table of contents
\renewcommand{\contentsname}{Contents}
\renewcommand{\cfttoctitlefont}{\normalfont\Large\bfseries}
\renewcommand{\chaptername}{}
\renewcommand{\thechapter}{}
\renewcommand{\thesection}{}
\renewcommand{\numberline}{}
\renewcommand{\cftdot}{}

% rename table of contents function
\let\stdtableofcontents\tableofcontents
\renewcommand{\tableofcontents}{}

% rename bibliography function
\let\stdbibliography\bibliography
\renewcommand{\bibsection}{}
\renewcommand{\bibliography}{}
\setlength{\bibhang}{0pt}

% set up book index
\makeindex

% enable roman numerals for backmatter
\makeatletter
\patchcmd{\backmatter}
{\@mainmatterfalse}
{\@mainmatterfalse\pagenumbering{roman}}
{}
{}
\makeatother

% make figures static
\let\origfigure\figure
\let\endorigfigure\endfigure
\renewenvironment{figure}[1][2] {
  \expandafter\origfigure\expandafter[H]
} {
  \endorigfigure
}

% initialize front matter
\frontmatter

% skip fist page
\AtBeginDocument{\AtBeginShipoutNext{\AtBeginShipoutDiscard}}

% create custom Begin and End cmds to ensure that Pandoc parses references
% see https://stackoverflow.com/a/41005796/3483791
\let\Begin\begin
\let\End\end
